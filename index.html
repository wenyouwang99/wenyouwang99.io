<!DOCTYPE html>












  


<html class="theme-next mist use-motion" lang>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">






















<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">

<link rel="stylesheet" href="/css/main.css?v=7.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.2.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.2.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.2.0">


  <link rel="mask-icon" href="/images/logo.svg?v=7.2.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '7.2.0',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="https://wenyouwang99.io/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">





  
  
  <link rel="canonical" href="https://wenyouwang99.io/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Hexo</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Cambiar a barra de navegación">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home menu-item-active">

    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Inicio</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archivo</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wenyouwang99.io/2019/08/11/统计乘用车辆，商用车辆的数量销售和销售额分布/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="WenYouWang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/08/11/统计乘用车辆，商用车辆的数量销售和销售额分布/" class="post-title-link" itemprop="url">Sin título</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Publicado el</span>
              

              
                
              

              <time title="Creado por: 2019-08-11 17:47:01" itemprop="dateCreated datePublished" datetime="2019-08-11T17:47:01+08:00">2019-08-11</time>
            </span>
          

          

          

          
            
            
          

          
          

          

          <br>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="统计乘用车辆，商用车辆的数量销售和销售额分布"><a href="#统计乘用车辆，商用车辆的数量销售和销售额分布" class="headerlink" title="统计乘用车辆，商用车辆的数量销售和销售额分布"></a>统计乘用车辆，商用车辆的数量销售和销售额分布</h2><p>/**<br>     * 根据汽车所属（个人，商用）来进行划分<br>     * 计算乘用车辆，商用车辆各自的数量，以及各自所占的比重<br>     */<br>    public static class CountMap extends Mapper&lt;LongWritable, Text, Text, LongWritable&gt;{</p>
<pre><code>    @Override
    public void map(LongWritable key, Text value,                
            Mapper&lt;LongWritable, Text, Text, LongWritable&gt;.Context context)
            throws IOException, InterruptedException {

        String [] owns = value.toString().trim().split(&quot; &quot;);
        if(null != owns &amp;&amp; owns.length &gt; 10 &amp;&amp; owns[10] != null) {
            if(owns[10].equals(&quot;非营运&quot;)) {
                context.write(new Text(&quot;乘用车辆&quot;), new LongWritable(1));
            }else {
                context.write(new Text(&quot;商用车辆&quot;), new LongWritable(1));
            }
        }             
    };
}




/**
 * 统计乘用车辆和商用车辆的数量以及他们的总量
 */
public static class CountReduce extends Reducer&lt;Text, LongWritable, Text, DoubleWritable&gt; {
    Map&lt;String,Long&gt; maps = new HashMap&lt;String,Long&gt;();
    //准备存放非营运的乘用车辆和营运的商用车辆的总和
    double all = 0;
    @Override
    public void reduce(Text key, Iterable&lt;LongWritable&gt; values,Context context) throws IOException, InterruptedException {
         Long sum = (long) 0;
         for (LongWritable val : values) {
            sum += val.get();
        }
         //求出车辆的总和
         all += sum;
         maps.put(key.toString(),sum);
    };

    protected  void cleanup(
            org.apache.hadoop.mapreduce.Reducer&lt;Text, LongWritable, Text, DoubleWritable&gt;.Context context) throws IOException, InterruptedException {
        Set&lt;String&gt; keySet = maps.keySet();
        //循环set集合中的乘用车辆和商用车辆的数量
        for (String str : keySet) {
            long value = maps.get(str);
            //用乘用车辆/总量  和  商用车辆/总量，求出各自的比例
            double percent = value/all;
            //输出的key为车辆类型，value的值为该车辆类型的占比
            context.write(new Text(str), new DoubleWritable(percent));
        }
    };
}</code></pre>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wenyouwang99.io/2019/08/10/二次排序/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="WenYouWang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/08/10/二次排序/" class="post-title-link" itemprop="url">Sin título</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Publicado el</span>
              

              
                
              

              <time title="Creado por: 2019-08-10 20:13:35 / Modificado por: 20:18:52" itemprop="dateCreated datePublished" datetime="2019-08-10T20:13:35+08:00">2019-08-10</time>
            </span>
          

          
            

            
          

          

          
            
            
          

          
          

          

          <br>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="二次排序（对key-value都排序）"><a href="#二次排序（对key-value都排序）" class="headerlink" title="二次排序（对key,value都排序）"></a>二次排序（对key,value都排序）</h2><pre><code>import org.apache.hadoop.conf.Configured;</code></pre><p>   import org.apache.hadoop.io.WritableComparable;<br>   import java.io.DataInput;<br>   import java.io.DataOutput;<br>   import java.io.IOException;<br>   import org.apache.hadoop.io.*;<br>   import org.apache.hadoop.mapreduce.Partitioner;<br>   import org.apache.hadoop.mapreduce.Mapper;<br>   import org.apache.hadoop.mapreduce.Reducer;<br>  import org.apache.hadoop.conf.Configuration;<br>  import org.apache.hadoop.fs.FileSystem;<br>  import org.apache.hadoop.fs.Path;<br>  import org.apache.hadoop.mapreduce.Job;<br>  import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;<br>  import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<br>  import org.apache.hadoop.mapreduce.lib.input.TextInputFormat;<br>  import org.apache.hadoop.mapreduce.lib.output.TextOutputFormat;<br>  import org.apache.hadoop.util.Tool;<br>  import org.apache.hadoop.util.ToolRunner;<br>  import org.slf4j.Logger;<br>  import org.slf4j.LoggerFactory;</p>
<p>  public class SecondrySort extends Configured implements Tool {</p>
<pre><code>static class Fruit implements WritableComparable&lt;Fruit&gt;{
    private static final Logger logger = LoggerFactory.getLogger(Fruit.class);
    private String date;
   private String name;
  private Integer sales;
  public Fruit(){
   }
  public Fruit(String date,String name,Integer sales){
      this.date = date;
       this.name = name;
      this.sales = sales;
   }

 public String getDate(){
       return this.date;
   }

  public String getName(){
      return this.name;
   }

   public Integer getSales(){
      return this.sales;
   }

   @Override
   public void readFields(DataInput in) throws IOException{
      this.date = in.readUTF();
      this.name = in.readUTF();
       this.sales = in.readInt();
  }

  @Override
   public void write(DataOutput out) throws IOException{
       out.writeUTF(this.date);
      out.writeUTF(this.name);
      out.writeInt(sales);
   }

  @Override
   public int compareTo(Fruit other) {
      int result1 = this.date.compareTo(other.getDate());
       if(result1 == 0) {
          int result2 = this.sales - other.getSales();
          if (result2 == 0) {
              double result3 = this.name.compareTo(other.getName());
              if(result3 &gt; 0) return -1;
              else if(result3 &lt; 0) return 1;
              else return 0;
          }else if(result2 &gt;0){
               return -1;
          }else if(result2 &lt; 0){
              return 1;
           }
       }else if(result1 &gt; 0){
          return -1;
       }else{
         return 1;
       }
      return 0;
  }

   @Override
   public int hashCode(){
      return this.date.hashCode() * 157 + this.sales + this.name.hashCode();
   }

   @Override
  public boolean equals(Object object){
       if (object == null)
          return false;
       if (this == object)
          return true;
      if (object instanceof Fruit){
          Fruit r = (Fruit) object;</code></pre><p> //                if(r.getDate().toString().equals(this.getDate().toString())){<br>                 return r.getDate().equals(this.getDate()) &amp;&amp; r.getName().equals(this.getName())<br>                        &amp;&amp; this.getSales() == r.getSales();<br>             }else{<br>                return false;<br>            }<br>        }</p>
<pre><code>     public String toString() {
        return this.date + &quot; &quot; + this.name + &quot; &quot; + this.sales;
     }

}

static class FruitPartition extends Partitioner&lt;Fruit, NullWritable&gt;{
    @Override
     public int getPartition(Fruit key, NullWritable value,int numPartitions){
        return Math.abs(Integer.parseInt(key.getDate()) * 127) % numPartitions;
     }</code></pre><p>   }</p>
<pre><code> public static class GroupingComparator extends WritableComparator{
     protected GroupingComparator(){
        super(Fruit.class, true);
     }

     @Override
     public int compare(WritableComparable w1, WritableComparable w2){
        Fruit f1 = (Fruit) w1;
        Fruit f2 = (Fruit) w2;

        if(!f1.getDate().equals(f2.getDate())){
            return f1.getDate().compareTo(f2.getDate());
        }else{
            return f1.getSales().compareTo(f2.getSales());
        }
    }
 }

 public static class Map extends Mapper&lt;LongWritable, Text, Fruit, NullWritable&gt; {

    public void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException {
        String line = value.toString();
        String str[] = line.split(&quot; &quot;);
        Fruit fruit = new Fruit(str[0],str[1],new Integer(str[2]));
         //Fruit fruit = new Fruit();
         //fruit.set(str[0],str[1],new Integer(str[2]));
         context.write(fruit, NullWritable.get());
    }
 }

 public static class Reduce extends Reducer&lt;Fruit, NullWritable, Text, NullWritable&gt; {

     public void reduce(Fruit key, Iterable&lt;NullWritable&gt; values, Context context) throws IOException, InterruptedException {
        String str = key.getDate() + &quot; &quot; + key.getName() + &quot; &quot; + key.getSales();
        context.write(new Text(str), NullWritable.get());
    }
}

@Override
public int run(String[] args) throws Exception {
    Configuration conf = new Configuration();
     // 判断路径是否存在，如果存在，则删除
    Path mypath = new Path(args[1]);
    FileSystem hdfs = mypath.getFileSystem(conf);
     if (hdfs.isDirectory(mypath)) {
         hdfs.delete(mypath, true);
    }

     Job job = Job.getInstance(conf, &quot;Secondry Sort app&quot;);
   // 设置主类
     job.setJarByClass(SecondrySort.class);

     // 输入路径
    FileInputFormat.setInputPaths(job, new Path(args[0]));
    // 输出路径
    FileOutputFormat.setOutputPath(job, new Path(args[1]));

    // Mapper
     job.setMapperClass(Map.class);
    // Reducer
    job.setReducerClass(Reduce.class);

    // 分区函数
     job.setPartitionerClass(FruitPartition.class);

    // 分组函数
     job.setGroupingComparatorClass(GroupingComparator.class);

    // map输出key类型
    job.setMapOutputKeyClass(Fruit.class);
     // map输出value类型
    job.setMapOutputValueClass(NullWritable.class);

    // reduce输出key类型
     job.setOutputKeyClass(Text.class);
     // reduce输出value类型
    job.setOutputValueClass(NullWritable.class);

     // 输入格式
     job.setInputFormatClass(TextInputFormat.class);
     // 输出格式
     job.setOutputFormatClass(TextOutputFormat.class);

    return job.waitForCompletion(true) ? 0 : 1;
 }

 public static void main(String[] args) throws Exception{
     int exitCode = ToolRunner.run(new SecondrySort(), args);
     System.exit(exitCode);
 }</code></pre><p> }</p>
<p>测试数据：</p>
<p>20180906 Apple 200<br>20180904 Apple 200<br>20180905 Banana 100<br>20180906 Orange 300<br>20180906 Banana 400<br>20180904 Orange 100<br>20180905 Apple 400<br>20180904 Banana 300<br>20180905 Orange 500</p>
<p>运行结果：</p>
<p>20180906 Banana 400<br>20180906 Orange 300<br>20180906 Apple 200<br>20180905 Orange 500<br>20180905 Apple 400<br>20180905 Banana 100<br>20180904 Banana 300<br>20180904 Apple 200<br>20180904 Orange 100</p>
<p>总结：</p>
<p>1、在使用实现WritableComparable接口的方式实现自定义比较器时，必须有一个无参的构造函数。否则会报Unable to initialize any output collector的错误。<br>2、readFields和write方法中处理字段的顺序必须一致，否则会报MapReduce Error: java.io.EOFException at java.io.DataInputStream.readFully(DataInputStream.java:197)的错误。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wenyouwang99.io/2019/08/09/数据去重/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="WenYouWang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/08/09/数据去重/" class="post-title-link" itemprop="url">Sin título</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Publicado el</span>
              

              
                
              

              <time title="Creado por: 2019-08-09 18:56:25" itemprop="dateCreated datePublished" datetime="2019-08-09T18:56:25+08:00">2019-08-09</time>
            </span>
          

          

          

          
            
            
          

          
          

          

          <br>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="数据去重"><a href="#数据去重" class="headerlink" title="数据去重"></a>数据去重</h2><p>  public static class Map extends Mapper&lt;Object, Text, Text, Text&gt;{<br>        private static Text line = new Text();</p>
<pre><code>    public void map(Object key,Text value,Context context)throws IOException, InterruptedException{
        line = value;
        context.write(line, new Text(&quot;&quot;));
    }        
}



public static class Reduce extends Reducer&lt;Text, Text, Text, Text&gt; {
    protected void reduce(Text key, Iterable&lt;Text&gt; values,Context context) throws IOException, InterruptedException {
        context.write(key, new Text(&quot;&quot;));
    }
}</code></pre>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wenyouwang99.io/2019/08/09/数据排序/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="WenYouWang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/08/09/数据排序/" class="post-title-link" itemprop="url">Sin título</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Publicado el</span>
              

              
                
              

              <time title="Creado por: 2019-08-09 18:55:12" itemprop="dateCreated datePublished" datetime="2019-08-09T18:55:12+08:00">2019-08-09</time>
            </span>
          

          

          

          
            
            
          

          
          

          

          <br>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="数据排序"><a href="#数据排序" class="headerlink" title="数据排序"></a>数据排序</h2><p>  public static class Map extends Mapper&lt;Object, Text, IntWritable, IntWritable&gt;{<br>        private static IntWritable data = new IntWritable();</p>
<pre><code>    public void map(Object key,Text value,Context context)throws IOException, InterruptedException{
        String line = value.toString();
        data.set(Integer.parseInt(line));
        context.write(data, new IntWritable(1));
    }        
}




public static class Reduce extends Reducer&lt;IntWritable, IntWritable, IntWritable, IntWritable&gt; {
    private static IntWritable linenum = new IntWritable(1);
    protected void reduce(IntWritable key, Iterable&lt;IntWritable&gt; values,Context context) throws IOException, InterruptedException {
        for (IntWritable val : values) {
            context.write(linenum, key);
            linenum = new IntWritable(linenum.get()+1);
        }
    }
}</code></pre>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wenyouwang99.io/2019/08/09/平均成绩/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="WenYouWang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/08/09/平均成绩/" class="post-title-link" itemprop="url">Sin título</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Publicado el</span>
              

              
                
              

              <time title="Creado por: 2019-08-09 18:53:39" itemprop="dateCreated datePublished" datetime="2019-08-09T18:53:39+08:00">2019-08-09</time>
            </span>
          

          

          

          
            
            
          

          
          

          

          <br>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="平均成绩"><a href="#平均成绩" class="headerlink" title="平均成绩"></a>平均成绩</h2><p>mapreduce 计算平均成绩</p>
<p>  public static class Map extends Mapper&lt;LongWritable, Text, Text, IntWritable&gt;{<br>        private static IntWritable data = new IntWritable();</p>
<pre><code>    public void map(LongWritable key,Text value,Context context)throws IOException, InterruptedException{
        String line = value.toString();
        String [] ss = line.split(&quot; &quot;);        
        String strName = ss[0];
        String strScore = ss[1];        
        Text name = new Text(strName);
        int scoreInt =     Integer.parseInt(strScore);
        context.write(name, new IntWritable(scoreInt));
    }        
}




public static class Reduce extends Reducer&lt;Text, IntWritable, Text, IntWritable&gt; {
    protected void reduce(Text key, Iterable&lt;IntWritable&gt; values,Context context) throws IOException, InterruptedException {
        int sum = 0;
        int count = 0;
        Iterator&lt;IntWritable&gt; iterator = values.iterator();
        while(iterator.hasNext()) {
            sum += iterator.next().get();
            count++;
        }
        int average = (int)sum/count;
        context.write(key, new IntWritable(average));
    }
}</code></pre>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wenyouwang99.io/2019/08/06/在eclipse中向hdfs上传文件/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="WenYouWang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/08/06/在eclipse中向hdfs上传文件/" class="post-title-link" itemprop="url">Sin título</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Publicado el</span>
              

              
                
              

              <time title="Creado por: 2019-08-06 21:35:27 / Modificado por: 21:37:07" itemprop="dateCreated datePublished" datetime="2019-08-06T21:35:27+08:00">2019-08-06</time>
            </span>
          

          
            

            
          

          

          
            
            
          

          
          

          

          <br>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="在eclipse中向hdfs上传文件"><a href="#在eclipse中向hdfs上传文件" class="headerlink" title="在eclipse中向hdfs上传文件"></a>在eclipse中向hdfs上传文件</h2><p>public class hdfs {</p>
<pre><code>static FileSystem fs = null;
static{
Configuration conf = new Configuration();
String path = null;
//fs = FileSystem.get(new URI(&quot;hdfs://192.168.8.10:9000&quot;),conf,root);
try {
    fs = FileSystem.get(new URI(&quot;hdfs://192.168.8.10:9000&quot;),conf,path);
} catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} catch (InterruptedException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} catch (URISyntaxException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
}
}
public static void copyFromLocal() throws IOException {
fs.copyFromLocalFile(new Path(&quot;D:\\text\\123.txt&quot;),new Path(&quot;/input/123&quot;));
System.out.println(&quot;finished...&quot;);
}    </code></pre><p>}</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wenyouwang99.io/2019/08/06/解决eclipse中无法执行向hadoop上传文件问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="WenYouWang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/08/06/解决eclipse中无法执行向hadoop上传文件问题/" class="post-title-link" itemprop="url">Sin título</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Publicado el</span>
              

              
                
              

              <time title="Creado por: 2019-08-06 21:29:08" itemprop="dateCreated datePublished" datetime="2019-08-06T21:29:08+08:00">2019-08-06</time>
            </span>
          

          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Editado el</span>
                
                <time title="Modificado por: 2019-08-10 20:20:56" itemprop="dateModified" datetime="2019-08-10T20:20:56+08:00">2019-08-10</time>
              </span>
            
          

          

          
            
            
          

          
          

          

          <br>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="解决eclipse中无法执行向hadoop上传文件问题"><a href="#解决eclipse中无法执行向hadoop上传文件问题" class="headerlink" title="解决eclipse中无法执行向hadoop上传文件问题"></a>解决eclipse中无法执行向hadoop上传文件问题</h2><p>main……的问题</p>
<p>Permission denied: user=zhuy, access=WRITE, inode=”/user”:root:supergroup:drwxr-xr-x<br>从这句话我们可知道是权限问题</p>
<p>所以要修改权限在  hdfs-site.xml加入如下代码   （每台都要修改）</p>
<pre><code>&lt;property&gt;
    &lt;name&gt;dfs.permissions&lt;/name&gt;
    &lt;value&gt;false&lt;/value&gt;
    &lt;description&gt;
      If &quot;true&quot;, enable permission checking in HDFS.
      If &quot;false&quot;, permission checking is turned off,
      but all other behavior is unchanged.
      Switching from one parameter value to the other does not change the mode,
      owner or group of files or directories.
    &lt;/description&gt;
&lt;/property&gt;</code></pre>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wenyouwang99.io/2019/08/06/hdfs文件读取2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="WenYouWang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/08/06/hdfs文件读取2/" class="post-title-link" itemprop="url">Sin título</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Publicado el</span>
              

              
                
              

              <time title="Creado por: 2019-08-06 20:45:49 / Modificado por: 20:51:54" itemprop="dateCreated datePublished" datetime="2019-08-06T20:45:49+08:00">2019-08-06</time>
            </span>
          

          
            

            
          

          

          
            
            
          

          
          

          

          <br>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="hdfs文件的读取-在eclipse中D-text-text-txt01输出-其中text01-txt不必创建，自动生成"><a href="#hdfs文件的读取-在eclipse中D-text-text-txt01输出-其中text01-txt不必创建，自动生成" class="headerlink" title="hdfs文件的读取  (在eclipse中D:\text\text.txt01输出   其中text01.txt不必创建，自动生成 )"></a>hdfs文件的读取  (在eclipse中D:\text\text.txt01输出   其中text01.txt不必创建，自动生成 )</h2><p>package com.qf.a.b;</p>
<p>import java.io.File;<br>import java.io.FileOutputStream;<br>import java.io.IOException;<br>import java.io.OutputStream;<br>import java.net.URI;</p>
<p>public static void readFileToLocal(String path) throws IOException {</p>
<pre><code>FSDataInputStream fis = null;
OutputStream out = null;

try{

Configuration conf = new Configuration();

FileSystem fs = FileSystem.get(new URI(&quot;hdfs://192.168.8.10:9000&quot;),conf,path);
fis = fs.open(new Path(path));
out = new FileOutputStream(new File(&quot;D:\\text\\text.txt01&quot;));
IOUtils.copyBytes(fis, System.out, 4096, true);

}catch(Exception e){

}finally{
    fis.close();
    out.close();

}

}</code></pre>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wenyouwang99.io/2019/08/06/hdfs文件的读取/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="WenYouWang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/08/06/hdfs文件的读取/" class="post-title-link" itemprop="url">Sin título</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Publicado el</span>
              

              
                
              

              <time title="Creado por: 2019-08-06 20:14:14 / Modificado por: 20:46:06" itemprop="dateCreated datePublished" datetime="2019-08-06T20:14:14+08:00">2019-08-06</time>
            </span>
          

          
            

            
          

          

          
            
            
          

          
          

          

          <br>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="hdfs文件的读取-在eclipse中console输出"><a href="#hdfs文件的读取-在eclipse中console输出" class="headerlink" title="hdfs文件的读取  (在eclipse中console输出)"></a>hdfs文件的读取  (在eclipse中console输出)</h2><p>package com.qf.a.b;</p>
<p>import java.io.IOException;</p>
<p>import org.apache.hadoop.conf.Configuration;<br>import org.apache.hadoop.fs.FSDataInputStream;<br>import org.apache.hadoop.fs.FileSystem;<br>import org.apache.hadoop.fs.Path;<br>import org.apache.hadoop.io.IOUtils;</p>
<p>public class hdfs {<br>    public static void main(String[] args) throws IOException {<br>        readFileToConsole(“/input/a.txt”);<br>    }</p>
<pre><code>public static void readFileToConsole(String pat) throws IOException {
    Configuration conf = new Configuration();
    conf.set(&quot;fs.defaultFS&quot;,&quot;hdfs://192.168.8.10:9000&quot;);
    FileSystem fs = FileSystem.get(conf);
    //String path = null;
    //FSDataInputStream fis = fs.open(new Path(path));
    FSDataInputStream fis = fs.open(new Path(&quot;/input/a.txt&quot;));
    IOUtils.copyBytes(fis, System.out, 4096, true);


}</code></pre><p>}</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://wenyouwang99.io/2019/08/06/maven安装1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="WenYouWang">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/08/06/maven安装1/" class="post-title-link" itemprop="url">Sin título</a>
              
            
          </h1>
        

        <div class="post-meta">

          
          
          

          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Publicado el</span>
              

              
                
              

              <time title="Creado por: 2019-08-06 20:04:00" itemprop="dateCreated datePublished" datetime="2019-08-06T20:04:00+08:00">2019-08-06</time>
            </span>
          

          

          

          
            
            
          

          
          

          

          <br>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="在windows下安装maven"><a href="#在windows下安装maven" class="headerlink" title="在windows下安装maven"></a>在windows下安装maven</h2><h2 id="1-先在官网下载maven-并解压在自定义路径"><a href="#1-先在官网下载maven-并解压在自定义路径" class="headerlink" title="1.先在官网下载maven,并解压在自定义路径"></a>1.先在官网下载maven,并解压在自定义路径</h2><p>我的路径 D:\java\maven\apache-maven-3.6.1</p>
<h2 id="2-修改配置文件"><a href="#2-修改配置文件" class="headerlink" title="2.修改配置文件"></a>2.修改配置文件</h2><p>D:\java\maven\apache-maven-3.6.1\conf\settings</p>
<!-- localRepository
   | The path to the local repository maven will use to store artifacts.
   |
   | Default: ${user.home}/.m2/repository
  <localRepository>/path/to/local/repo</localRepository>
  -->
<p>  <localrepository>D:\java\mavenrepository</localrepository><br>  自定义maven仓库路径，里面是存放jar包的</p>
<h2 id="3-修改环境变量"><a href="#3-修改环境变量" class="headerlink" title="3.修改环境变量"></a>3.修改环境变量</h2><p>在系统变量中添加<br>MAVEN_HOME<br>D:\java\maven\apache-maven-3.6.1</p>
<p>Path<br>D:\java\maven\apache-maven-3.6.1\bin</p>
<h2 id="4-测试是否安装成功"><a href="#4-测试是否安装成功" class="headerlink" title="4.测试是否安装成功"></a>4.测试是否安装成功</h2><p>win+r<br>mvn -v</p>
<h2 id="5-打开eclipse-配置maven"><a href="#5-打开eclipse-配置maven" class="headerlink" title="5.打开eclipse,配置maven"></a>5.打开eclipse,配置maven</h2><p>window–&gt;preference–&gt;maven–&gt;installations–&gt;add–&gt;<br>D:\java\maven\apache-maven-3.6.1–&gt;apply</p>
<p>window–&gt;preference–&gt;maven–&gt;user settings–&gt;update<br>如果更新后仓库路径和 2.修改配置文件 路径一样，则apply后退出即可</p>
<h2 id="6-创建maven工程，配置pom-xml-这个镜像可用"><a href="#6-创建maven工程，配置pom-xml-这个镜像可用" class="headerlink" title="6.创建maven工程，配置pom.xml    (这个镜像可用)"></a>6.创建maven工程，配置pom.xml    (这个镜像可用)</h2>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Página siguiente"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">WenYouWang</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">15</span>
                    <span class="site-state-item-name">entradas</span>
                  </a>
                </div>
              

              

              
            </nav>
          

          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">WenYouWang</span>

  

  
</div>


  <div class="powered-by">Creado mediante <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.9.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Tema – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v7.2.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=3.4.1"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.2.0"></script>

  <script src="/js/motion.js?v=7.2.0"></script>



  
  


  <script src="/js/schemes/muse.js?v=7.2.0"></script>




  

  


  <script src="/js/next-boot.js?v=7.2.0"></script>


  

  

  

  



  




  

  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
