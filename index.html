<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
<title>Hexo</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



    <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="https://wenyouwang99.io/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://wenyouwang99.io/images/og_image.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">
<meta name="twitter:image" content="https://wenyouwang99.io/images/og_image.png">







<link rel="icon" href="/images/favicon.svg">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
    
    <style>body>.footer,body>.navbar,body>.section{opacity:0}</style>
    

    
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">
    

    
    

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">


    
    
    
    

<link rel="stylesheet" href="/css/back-to-top.css">


    
    

    
    
    
    

    
    
<link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

    
    
    

    
    
    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.svg" alt="Hexo" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item is-active" href="/">Home</a>
                
                <a class="navbar-item" href="/archives">Archives</a>
                
                <a class="navbar-item" href="/categories">Categories</a>
                
                <a class="navbar-item" href="/tags">Tags</a>
                
                <a class="navbar-item" href="/about">About</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    
                    <a class="navbar-item" target="_blank" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                
                
                
                <a class="navbar-item search" title="Search" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2 column-main">
    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-08-12T11:30:22.851Z">2019-08-12</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a few seconds read (About 32 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/08/12/test1/"></a>
            
        </h1>
        <div class="content">
            <p>title: 标签测试<br>tags:</p>
<ul>
<li>Testing                   （这个就是文章的标签了）</li>
<li>Another Tag               （这个就是文章的标签了</li>
</ul>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-08-12T11:29:38.712Z">2019-08-12</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a few seconds read (About 19 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/08/12/test/"></a>
            
        </h1>
        <div class="content">
            <p>title: 分类测试<br>categories:</p>
<ul>
<li>hexo                       （这个就是文章的分类了）</li>
</ul>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-08-11T09:47:01.730Z">2019-08-11</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    2 minutes read (About 320 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/08/11/统计乘用车辆，商用车辆的数量销售和销售额分布/"></a>
            
        </h1>
        <div class="content">
            <h2 id="统计乘用车辆，商用车辆的数量销售和销售额分布"><a href="#统计乘用车辆，商用车辆的数量销售和销售额分布" class="headerlink" title="统计乘用车辆，商用车辆的数量销售和销售额分布"></a>统计乘用车辆，商用车辆的数量销售和销售额分布</h2><p>/**<br>     * 根据汽车所属（个人，商用）来进行划分<br>     * 计算乘用车辆，商用车辆各自的数量，以及各自所占的比重<br>     */<br>    public static class CountMap extends Mapper&lt;LongWritable, Text, Text, LongWritable&gt;{</p>
<pre><code>    @Override
    public void map(LongWritable key, Text value,                
            Mapper&lt;LongWritable, Text, Text, LongWritable&gt;.Context context)
            throws IOException, InterruptedException {

        String [] owns = value.toString().trim().split(&quot; &quot;);
        if(null != owns &amp;&amp; owns.length &gt; 10 &amp;&amp; owns[10] != null) {
            if(owns[10].equals(&quot;非营运&quot;)) {
                context.write(new Text(&quot;乘用车辆&quot;), new LongWritable(1));
            }else {
                context.write(new Text(&quot;商用车辆&quot;), new LongWritable(1));
            }
        }             
    };
}




/**
 * 统计乘用车辆和商用车辆的数量以及他们的总量
 */
public static class CountReduce extends Reducer&lt;Text, LongWritable, Text, DoubleWritable&gt; {
    Map&lt;String,Long&gt; maps = new HashMap&lt;String,Long&gt;();
    //准备存放非营运的乘用车辆和营运的商用车辆的总和
    double all = 0;
    @Override
    public void reduce(Text key, Iterable&lt;LongWritable&gt; values,Context context) throws IOException, InterruptedException {
         Long sum = (long) 0;
         for (LongWritable val : values) {
            sum += val.get();
        }
         //求出车辆的总和
         all += sum;
         maps.put(key.toString(),sum);
    };

    protected  void cleanup(
            org.apache.hadoop.mapreduce.Reducer&lt;Text, LongWritable, Text, DoubleWritable&gt;.Context context) throws IOException, InterruptedException {
        Set&lt;String&gt; keySet = maps.keySet();
        //循环set集合中的乘用车辆和商用车辆的数量
        for (String str : keySet) {
            long value = maps.get(str);
            //用乘用车辆/总量  和  商用车辆/总量，求出各自的比例
            double percent = value/all;
            //输出的key为车辆类型，value的值为该车辆类型的占比
            context.write(new Text(str), new DoubleWritable(percent));
        }
    };
}</code></pre>
        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-08-10T12:13:35.519Z">2019-08-10</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    6 minutes read (About 830 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/08/10/二次排序/"></a>
            
        </h1>
        <div class="content">
            <h2 id="二次排序（对key-value都排序）"><a href="#二次排序（对key-value都排序）" class="headerlink" title="二次排序（对key,value都排序）"></a>二次排序（对key,value都排序）</h2><pre><code>import org.apache.hadoop.conf.Configured;</code></pre><p>   import org.apache.hadoop.io.WritableComparable;<br>   import java.io.DataInput;<br>   import java.io.DataOutput;<br>   import java.io.IOException;<br>   import org.apache.hadoop.io.*;<br>   import org.apache.hadoop.mapreduce.Partitioner;<br>   import org.apache.hadoop.mapreduce.Mapper;<br>   import org.apache.hadoop.mapreduce.Reducer;<br>  import org.apache.hadoop.conf.Configuration;<br>  import org.apache.hadoop.fs.FileSystem;<br>  import org.apache.hadoop.fs.Path;<br>  import org.apache.hadoop.mapreduce.Job;<br>  import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;<br>  import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<br>  import org.apache.hadoop.mapreduce.lib.input.TextInputFormat;<br>  import org.apache.hadoop.mapreduce.lib.output.TextOutputFormat;<br>  import org.apache.hadoop.util.Tool;<br>  import org.apache.hadoop.util.ToolRunner;<br>  import org.slf4j.Logger;<br>  import org.slf4j.LoggerFactory;</p>
<p>  public class SecondrySort extends Configured implements Tool {</p>
<pre><code>static class Fruit implements WritableComparable&lt;Fruit&gt;{
    private static final Logger logger = LoggerFactory.getLogger(Fruit.class);
    private String date;
   private String name;
  private Integer sales;
  public Fruit(){
   }
  public Fruit(String date,String name,Integer sales){
      this.date = date;
       this.name = name;
      this.sales = sales;
   }

 public String getDate(){
       return this.date;
   }

  public String getName(){
      return this.name;
   }

   public Integer getSales(){
      return this.sales;
   }

   @Override
   public void readFields(DataInput in) throws IOException{
      this.date = in.readUTF();
      this.name = in.readUTF();
       this.sales = in.readInt();
  }

  @Override
   public void write(DataOutput out) throws IOException{
       out.writeUTF(this.date);
      out.writeUTF(this.name);
      out.writeInt(sales);
   }

  @Override
   public int compareTo(Fruit other) {
      int result1 = this.date.compareTo(other.getDate());
       if(result1 == 0) {
          int result2 = this.sales - other.getSales();
          if (result2 == 0) {
              double result3 = this.name.compareTo(other.getName());
              if(result3 &gt; 0) return -1;
              else if(result3 &lt; 0) return 1;
              else return 0;
          }else if(result2 &gt;0){
               return -1;
          }else if(result2 &lt; 0){
              return 1;
           }
       }else if(result1 &gt; 0){
          return -1;
       }else{
         return 1;
       }
      return 0;
  }

   @Override
   public int hashCode(){
      return this.date.hashCode() * 157 + this.sales + this.name.hashCode();
   }

   @Override
  public boolean equals(Object object){
       if (object == null)
          return false;
       if (this == object)
          return true;
      if (object instanceof Fruit){
          Fruit r = (Fruit) object;</code></pre><p> //                if(r.getDate().toString().equals(this.getDate().toString())){<br>                 return r.getDate().equals(this.getDate()) &amp;&amp; r.getName().equals(this.getName())<br>                        &amp;&amp; this.getSales() == r.getSales();<br>             }else{<br>                return false;<br>            }<br>        }</p>
<pre><code>     public String toString() {
        return this.date + &quot; &quot; + this.name + &quot; &quot; + this.sales;
     }

}

static class FruitPartition extends Partitioner&lt;Fruit, NullWritable&gt;{
    @Override
     public int getPartition(Fruit key, NullWritable value,int numPartitions){
        return Math.abs(Integer.parseInt(key.getDate()) * 127) % numPartitions;
     }</code></pre><p>   }</p>
<pre><code> public static class GroupingComparator extends WritableComparator{
     protected GroupingComparator(){
        super(Fruit.class, true);
     }

     @Override
     public int compare(WritableComparable w1, WritableComparable w2){
        Fruit f1 = (Fruit) w1;
        Fruit f2 = (Fruit) w2;

        if(!f1.getDate().equals(f2.getDate())){
            return f1.getDate().compareTo(f2.getDate());
        }else{
            return f1.getSales().compareTo(f2.getSales());
        }
    }
 }

 public static class Map extends Mapper&lt;LongWritable, Text, Fruit, NullWritable&gt; {

    public void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException {
        String line = value.toString();
        String str[] = line.split(&quot; &quot;);
        Fruit fruit = new Fruit(str[0],str[1],new Integer(str[2]));
         //Fruit fruit = new Fruit();
         //fruit.set(str[0],str[1],new Integer(str[2]));
         context.write(fruit, NullWritable.get());
    }
 }

 public static class Reduce extends Reducer&lt;Fruit, NullWritable, Text, NullWritable&gt; {

     public void reduce(Fruit key, Iterable&lt;NullWritable&gt; values, Context context) throws IOException, InterruptedException {
        String str = key.getDate() + &quot; &quot; + key.getName() + &quot; &quot; + key.getSales();
        context.write(new Text(str), NullWritable.get());
    }
}

@Override
public int run(String[] args) throws Exception {
    Configuration conf = new Configuration();
     // 判断路径是否存在，如果存在，则删除
    Path mypath = new Path(args[1]);
    FileSystem hdfs = mypath.getFileSystem(conf);
     if (hdfs.isDirectory(mypath)) {
         hdfs.delete(mypath, true);
    }

     Job job = Job.getInstance(conf, &quot;Secondry Sort app&quot;);
   // 设置主类
     job.setJarByClass(SecondrySort.class);

     // 输入路径
    FileInputFormat.setInputPaths(job, new Path(args[0]));
    // 输出路径
    FileOutputFormat.setOutputPath(job, new Path(args[1]));

    // Mapper
     job.setMapperClass(Map.class);
    // Reducer
    job.setReducerClass(Reduce.class);

    // 分区函数
     job.setPartitionerClass(FruitPartition.class);

    // 分组函数
     job.setGroupingComparatorClass(GroupingComparator.class);

    // map输出key类型
    job.setMapOutputKeyClass(Fruit.class);
     // map输出value类型
    job.setMapOutputValueClass(NullWritable.class);

    // reduce输出key类型
     job.setOutputKeyClass(Text.class);
     // reduce输出value类型
    job.setOutputValueClass(NullWritable.class);

     // 输入格式
     job.setInputFormatClass(TextInputFormat.class);
     // 输出格式
     job.setOutputFormatClass(TextOutputFormat.class);

    return job.waitForCompletion(true) ? 0 : 1;
 }

 public static void main(String[] args) throws Exception{
     int exitCode = ToolRunner.run(new SecondrySort(), args);
     System.exit(exitCode);
 }</code></pre><p> }</p>
<p>测试数据：</p>
<p>20180906 Apple 200<br>20180904 Apple 200<br>20180905 Banana 100<br>20180906 Orange 300<br>20180906 Banana 400<br>20180904 Orange 100<br>20180905 Apple 400<br>20180904 Banana 300<br>20180905 Orange 500</p>
<p>运行结果：</p>
<p>20180906 Banana 400<br>20180906 Orange 300<br>20180906 Apple 200<br>20180905 Orange 500<br>20180905 Apple 400<br>20180905 Banana 100<br>20180904 Banana 300<br>20180904 Apple 200<br>20180904 Orange 100</p>
<p>总结：</p>
<p>1、在使用实现WritableComparable接口的方式实现自定义比较器时，必须有一个无参的构造函数。否则会报Unable to initialize any output collector的错误。<br>2、readFields和write方法中处理字段的顺序必须一致，否则会报MapReduce Error: java.io.EOFException at java.io.DataInputStream.readFully(DataInputStream.java:197)的错误。</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-08-09T10:56:25.743Z">2019-08-09</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a few seconds read (About 58 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/08/09/数据去重/"></a>
            
        </h1>
        <div class="content">
            <h2 id="数据去重"><a href="#数据去重" class="headerlink" title="数据去重"></a>数据去重</h2><p>  public static class Map extends Mapper&lt;Object, Text, Text, Text&gt;{<br>        private static Text line = new Text();</p>
<pre><code>    public void map(Object key,Text value,Context context)throws IOException, InterruptedException{
        line = value;
        context.write(line, new Text(&quot;&quot;));
    }        
}



public static class Reduce extends Reducer&lt;Text, Text, Text, Text&gt; {
    protected void reduce(Text key, Iterable&lt;Text&gt; values,Context context) throws IOException, InterruptedException {
        context.write(key, new Text(&quot;&quot;));
    }
}</code></pre>
        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-08-09T10:55:12.862Z">2019-08-09</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a few seconds read (About 79 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/08/09/数据排序/"></a>
            
        </h1>
        <div class="content">
            <h2 id="数据排序"><a href="#数据排序" class="headerlink" title="数据排序"></a>数据排序</h2><p>  public static class Map extends Mapper&lt;Object, Text, IntWritable, IntWritable&gt;{<br>        private static IntWritable data = new IntWritable();</p>
<pre><code>    public void map(Object key,Text value,Context context)throws IOException, InterruptedException{
        String line = value.toString();
        data.set(Integer.parseInt(line));
        context.write(data, new IntWritable(1));
    }        
}




public static class Reduce extends Reducer&lt;IntWritable, IntWritable, IntWritable, IntWritable&gt; {
    private static IntWritable linenum = new IntWritable(1);
    protected void reduce(IntWritable key, Iterable&lt;IntWritable&gt; values,Context context) throws IOException, InterruptedException {
        for (IntWritable val : values) {
            context.write(linenum, key);
            linenum = new IntWritable(linenum.get()+1);
        }
    }
}</code></pre>
        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-08-09T10:53:39.751Z">2019-08-09</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a few seconds read (About 110 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/08/09/平均成绩/"></a>
            
        </h1>
        <div class="content">
            <h2 id="平均成绩"><a href="#平均成绩" class="headerlink" title="平均成绩"></a>平均成绩</h2><p>mapreduce 计算平均成绩</p>
<p>  public static class Map extends Mapper&lt;LongWritable, Text, Text, IntWritable&gt;{<br>        private static IntWritable data = new IntWritable();</p>
<pre><code>    public void map(LongWritable key,Text value,Context context)throws IOException, InterruptedException{
        String line = value.toString();
        String [] ss = line.split(&quot; &quot;);        
        String strName = ss[0];
        String strScore = ss[1];        
        Text name = new Text(strName);
        int scoreInt =     Integer.parseInt(strScore);
        context.write(name, new IntWritable(scoreInt));
    }        
}




public static class Reduce extends Reducer&lt;Text, IntWritable, Text, IntWritable&gt; {
    protected void reduce(Text key, Iterable&lt;IntWritable&gt; values,Context context) throws IOException, InterruptedException {
        int sum = 0;
        int count = 0;
        Iterator&lt;IntWritable&gt; iterator = values.iterator();
        while(iterator.hasNext()) {
            sum += iterator.next().get();
            count++;
        }
        int average = (int)sum/count;
        context.write(key, new IntWritable(average));
    }
}</code></pre>
        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-08-06T13:35:27.305Z">2019-08-06</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a few seconds read (About 91 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/08/06/在eclipse中向hdfs上传文件/"></a>
            
        </h1>
        <div class="content">
            <h2 id="在eclipse中向hdfs上传文件"><a href="#在eclipse中向hdfs上传文件" class="headerlink" title="在eclipse中向hdfs上传文件"></a>在eclipse中向hdfs上传文件</h2><p>public class hdfs {</p>
<pre><code>static FileSystem fs = null;
static{
Configuration conf = new Configuration();
String path = null;
//fs = FileSystem.get(new URI(&quot;hdfs://192.168.8.10:9000&quot;),conf,root);
try {
    fs = FileSystem.get(new URI(&quot;hdfs://192.168.8.10:9000&quot;),conf,path);
} catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} catch (InterruptedException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} catch (URISyntaxException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
}
}
public static void copyFromLocal() throws IOException {
fs.copyFromLocalFile(new Path(&quot;D:\\text\\123.txt&quot;),new Path(&quot;/input/123&quot;));
System.out.println(&quot;finished...&quot;);
}    </code></pre><p>}</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-08-06T13:29:08.157Z">2019-08-06</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a minute read (About 115 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/08/06/解决eclipse中无法执行向hadoop上传文件问题/"></a>
            
        </h1>
        <div class="content">
            <h2 id="解决eclipse中无法执行向hadoop上传文件问题"><a href="#解决eclipse中无法执行向hadoop上传文件问题" class="headerlink" title="解决eclipse中无法执行向hadoop上传文件问题"></a>解决eclipse中无法执行向hadoop上传文件问题</h2><p>main……的问题</p>
<p>Permission denied: user=zhuy, access=WRITE, inode=”/user”:root:supergroup:drwxr-xr-x<br>从这句话我们可知道是权限问题</p>
<p>所以要修改权限在  hdfs-site.xml加入如下代码   （每台都要修改）</p>
<pre><code>&lt;property&gt;
    &lt;name&gt;dfs.permissions&lt;/name&gt;
    &lt;value&gt;false&lt;/value&gt;
    &lt;description&gt;
      If &quot;true&quot;, enable permission checking in HDFS.
      If &quot;false&quot;, permission checking is turned off,
      but all other behavior is unchanged.
      Switching from one parameter value to the other does not change the mode,
      owner or group of files or directories.
    &lt;/description&gt;
&lt;/property&gt;</code></pre>
        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2019-08-06T12:45:49.641Z">2019-08-06</time>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    a few seconds read (About 110 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/08/06/hdfs文件读取2/"></a>
            
        </h1>
        <div class="content">
            <h2 id="hdfs文件的读取-在eclipse中D-text-text-txt01输出-其中text01-txt不必创建，自动生成"><a href="#hdfs文件的读取-在eclipse中D-text-text-txt01输出-其中text01-txt不必创建，自动生成" class="headerlink" title="hdfs文件的读取  (在eclipse中D:\text\text.txt01输出   其中text01.txt不必创建，自动生成 )"></a>hdfs文件的读取  (在eclipse中D:\text\text.txt01输出   其中text01.txt不必创建，自动生成 )</h2><p>package com.qf.a.b;</p>
<p>import java.io.File;<br>import java.io.FileOutputStream;<br>import java.io.IOException;<br>import java.io.OutputStream;<br>import java.net.URI;</p>
<p>public static void readFileToLocal(String path) throws IOException {</p>
<pre><code>FSDataInputStream fis = null;
OutputStream out = null;

try{

Configuration conf = new Configuration();

FileSystem fs = FileSystem.get(new URI(&quot;hdfs://192.168.8.10:9000&quot;),conf,path);
fis = fs.open(new Path(path));
out = new FileOutputStream(new File(&quot;D:\\text\\text.txt01&quot;));
IOUtils.copyBytes(fis, System.out, 4096, true);

}catch(Exception e){

}finally{
    fis.close();
    out.close();

}

}</code></pre>
        </div>
        
        
        
    </div>
</div>









    
<div class="card card-transparent">
    <nav class="pagination is-centered" role="navigation" aria-label="pagination">
        <div class="pagination-previous is-invisible is-hidden-mobile">
            <a class="is-flex-grow has-text-black-ter" href="/page/0/">Anterior</a>
        </div>
        <div class="pagination-next">
            <a class="is-flex-grow has-text-black-ter" href="/page/2/">Siguiente</a>
        </div>
        <ul class="pagination-list is-hidden-mobile">
            
            <li><a class="pagination-link is-current" href="/">1</a></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/2/">2</a></li>
            
        </ul>
    </nav>
</div>
</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered" style="flex-shrink: 1">
                <div>
                    
                        <img class="image is-128x128 has-mb-6" src="/images/avatar.png" alt="Your name">
                    
                    
                    <p class="is-size-4 is-block">
                        Your name
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        Your title
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>Your location</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Entradas
                    </p>
                    <p class="title has-text-weight-normal">
                        17
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Categorias
                    </p>
                    <p class="title has-text-weight-normal">
                        0
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        Etiquetas
                    </p>
                    <p class="title has-text-weight-normal">
                        0
                    </p>
                </div>
            </div>
        </nav>
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/ppoffice" target="_blank">
                SEGUIR</a>
        </div>
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank" title="Github" href="https://github.com/ppoffice">
                
                <i class="fab fa-github"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" title="Facebook" href="https://facebook.com">
                
                <i class="fab fa-facebook"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" title="Twitter" href="https://twitter.com">
                
                <i class="fab fa-twitter"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" title="Dribbble" href="https://dribbble.com">
                
                <i class="fab fa-dribbble"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" title="RSS" href="/">
                
                <i class="fas fa-rss"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        
    
        

<div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Links
        </h3>
        <ul class="menu-list">
        
            <li>
                <a class="level is-mobile" href="https://hexo.io" target="_blank">
                    <span class="level-left">
                        <span class="level-item">Hexo</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">hexo.io</span>
                    </span>
                </a>
            </li>
        
            <li>
                <a class="level is-mobile" href="https://github.com/ppoffice" target="_blank">
                    <span class="level-left">
                        <span class="level-item">PPOffice</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">github.com</span>
                    </span>
                </a>
            </li>
        
        </ul>
        </div>
    </div>
</div>


    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Categorias
            </h3>
            <ul class="menu-list">
            
            </ul>
        </div>
    </div>
</div>
    
        
    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
            
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Recientes
        </h3>
        
        <article class="media">
            
            <a href="/2019/08/12/test1/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt>
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-08-12T11:30:22.851Z">2019-08-12</time></div>
                    <a href="/2019/08/12/test1/" class="title has-link-black-ter is-size-6 has-text-weight-normal"></a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/08/12/test/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt>
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-08-12T11:29:38.712Z">2019-08-12</time></div>
                    <a href="/2019/08/12/test/" class="title has-link-black-ter is-size-6 has-text-weight-normal"></a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/08/11/统计乘用车辆，商用车辆的数量销售和销售额分布/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt>
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-08-11T09:47:01.730Z">2019-08-11</time></div>
                    <a href="/2019/08/11/统计乘用车辆，商用车辆的数量销售和销售额分布/" class="title has-link-black-ter is-size-6 has-text-weight-normal"></a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/08/10/二次排序/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt>
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-08-10T12:13:35.519Z">2019-08-10</time></div>
                    <a href="/2019/08/10/二次排序/" class="title has-link-black-ter is-size-6 has-text-weight-normal"></a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/08/09/数据去重/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt>
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-08-09T10:56:25.743Z">2019-08-09</time></div>
                    <a href="/2019/08/09/数据去重/" class="title has-link-black-ter is-size-6 has-text-weight-normal"></a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Archivos
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2019/08/">
                <span class="level-start">
                    <span class="level-item">August 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">13</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/07/">
                <span class="level-start">
                    <span class="level-item">July 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Etiquetas
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
            </div>
        </div>
    </div>
</div>
        
        </div>
    
</div>

                




<div class="column is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only has-order-3 column-right ">
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            Recientes
        </h3>
        
        <article class="media">
            
            <a href="/2019/08/12/test1/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt>
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-08-12T11:30:22.851Z">2019-08-12</time></div>
                    <a href="/2019/08/12/test1/" class="title has-link-black-ter is-size-6 has-text-weight-normal"></a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/08/12/test/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt>
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-08-12T11:29:38.712Z">2019-08-12</time></div>
                    <a href="/2019/08/12/test/" class="title has-link-black-ter is-size-6 has-text-weight-normal"></a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/08/11/统计乘用车辆，商用车辆的数量销售和销售额分布/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt>
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-08-11T09:47:01.730Z">2019-08-11</time></div>
                    <a href="/2019/08/11/统计乘用车辆，商用车辆的数量销售和销售额分布/" class="title has-link-black-ter is-size-6 has-text-weight-normal"></a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/08/10/二次排序/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt>
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-08-10T12:13:35.519Z">2019-08-10</time></div>
                    <a href="/2019/08/10/二次排序/" class="title has-link-black-ter is-size-6 has-text-weight-normal"></a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2019/08/09/数据去重/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt>
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2019-08-09T10:56:25.743Z">2019-08-09</time></div>
                    <a href="/2019/08/09/数据去重/" class="title has-link-black-ter is-size-6 has-text-weight-normal"></a>
                    <p class="is-size-7 is-uppercase">
                        
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            Archivos
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2019/08/">
                <span class="level-start">
                    <span class="level-item">August 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">13</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/07/">
                <span class="level-start">
                    <span class="level-item">July 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                Etiquetas
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
            </div>
        </div>
    </div>
</div>
    
    
</div>

            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.svg" alt="Hexo" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2019 WenYouWang&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>
                
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Creative Commons" href="https://creativecommons.org/">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("en");</script>


    
    
    
    <script src="/js/animation.js"></script>
    

    
    
    
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
    <script src="/js/gallery.js" defer></script>
    

    
    

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


    
    
<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>

    
    

<a id="back-to-top" title="Back to Top" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>


    
    

    
    
    
    

    
    
    
    
    
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>
    <script src="/js/clipboard.js" defer></script>
    

    
    
    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something...">
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: 'Entradas',
                PAGES: 'Pages',
                CATEGORIES: 'Categorias',
                TAGS: 'Etiquetas',
                UNTITLED: '(Untitled)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>